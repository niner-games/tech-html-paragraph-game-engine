<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Settings</title>

    <script src="js/autoloader.js"></script>
</head>
<body>

    <div id="background">
        <div class="container d-flex flex-column justify-content-center">
            <div class="row mb-3">
                <div class="col-12">
                    <div class="mb-4 text-center">
                        <div text="Customize the game to your needs."></div>
                    </div>
                </div>

                <div class="col-12 col-md-6 col-lg-4 mb-3">
                    <div id="language-overlay" class="overlay btn-group-vertical w-100" role="group" aria-label="Language"></div>
                </div>

                <div class="col-12 col-md-6 col-lg-4 mb-3">
                    <div id="theme-overlay" class="overlay btn-group-vertical w-100" role="group" aria-label="Template"></div>
                </div>

                <div class="col-12 col-md-6 col-lg-4 mb-3">
                    <div id="transformation-overlay" class="overlay btn-group-vertical w-100" role="group" aria-label="Style"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        window.addEventListener("load", function() {
            generateButtons(
                AutoLoader.languages,
                ['btn-success'],
                (event, key) => TranslationEngine.setLanguage(key),
                document.getElementById('language-overlay'),
                'language'
            );

            generateButtons(
                AutoLoader.themes,
                ['btn-warning'],
                (event, key) => ThemeEngine.setTheme(key),
                document.getElementById('theme-overlay'),
                'theme'
            );

            generateButtons(
                AutoLoader.transformations,
                ['btn-info'],
                (event, key) => ThemeEngine.setTransformation(key),
                document.getElementById('transformation-overlay'),
                'transformation'
            );
        });

        function generateButtons(sourceArray, colorsArray, eventListener, parentElement, storageKey) {
            let i = 0;
            let style = "ltr";

            for (let key in sourceArray) {
                if (sourceArray.hasOwnProperty(key)) {
                    let button = document.createElement("button");

                    style = (key === "iw") ? "rtl" : style;

                    button.value = key;
                    button.type = 'button';
                    button.style.direction = style;
                    button.textContent = sourceArray[key];

                    button.classList.add('btn');
                    button.classList.add(colorsArray[i % colorsArray.length]);

                    if (window.localStorage.getItem(storageKey) === key) {
                        button.classList.add('active');
                    }

                    button.addEventListener('click', (event) => eventListener(event, key));

                    parentElement.appendChild(button);

                    i++;
                }
            }
        }
    </script>

</body>
</html>